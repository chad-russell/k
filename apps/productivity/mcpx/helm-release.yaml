apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: mcpx
  namespace: mcpx
spec:
  interval: 15m
  chart:
    spec:
      chart: lunar-mcpx
      version: "v0.1.7"
      sourceRef:
        kind: HelmRepository
        name: lunar
        namespace: mcpx
      interval: 1h
  values:
    resources:
      requests:
        cpu: 250m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 1Gi
    config:
      mcpJson: |
        {
          "mcpServers": {
            "searxng": {
              "command": "npx",
              "args": ["-y", "@kevinwatt/mcp-server-searxng"],
              "env": {
                "SEARXNG_INSTANCES": "https://searxng.internal.crussell.io",
                "SEARXNG_USER_AGENT": "CustomBot/1.0",
                "NODE_TLS_REJECT_UNAUTHORIZED": "0"
              }
            }
          }
        }
      appYaml: |
        auth:
          enabled: false
        permissions:
          base: "allow"
        toolExtensions:
          services: {}
